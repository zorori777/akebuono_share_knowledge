# 第5章　Webサービスの設計

リソース指向アーキテクチャーアプローチとは

データを特定する
データをわける

リソースに名前をつける
クライアントに提供するリソースの表現を設計する
リンクとフォームを利用してリソース同士を結びつける


イベント標準的なコースを設計する
エラーについて検討する

書き込み時の注意点

作成は post も putも使える

**メリット**

- postをサーポートする必要がなくなる

- クライアントが作成と更新が区別する必要がなくなるため実装が簡単になる

**デメリット**
- クライアントがURIの構造を知っておく必要がある
- リクエストの見た目上 postとputの区別がつかなくなる


バッチ処理のとき失敗時はデータの整合性を担保するために二通り方法がある。

- transactionを貼っておく
- データを作成できたところと失敗した箇所をステータスのフォーマットで返すこと

楽観ロックの仕組み

自分が更新しようとしているリソースが更新されているかを確かめる

- 条件付きput

Etag if-Match
Last-Modified If-Unmodified-Match

Error: 412 Precondition Failed

を使用する




# リソースの設計方法

- 関係モデル思考法

中心となっているテーブルの一行をリソースの対象とする

主キーをURIにしてしまうとDBの構成が変わった時にURIも影響を受けるからあまり良くない。

正規化を崩して一度のリクエストでクライアントが必要とするデータを取得するようにする
=> サーバーやネットワークへの負担が軽減される

データの階層構造を考える
トップレベルリソースを考える

https://qiita.com/qsona



- オブジェクト指向モデル思考法
クラスのインスタンスがリソースの対象となる
階層構造はそれぞれのrelationから反映させやすい


所感
テーブルから設計するときとオブジェクトから設計するときって同じじゃんって思ったが、
Railsやってるとオブジェクト指向からER図を考えるからかな？



